<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudSync Desktop</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #121212; }
        ::-webkit-scrollbar-thumb { background: #535353; border-radius: 4px;}
        ::-webkit-scrollbar-thumb:hover { background: #808080; }
        
        .glass-header {
            background: rgba(18, 18, 18, 0);
            transition: background 0.3s ease;
        }
        .glass-header.scrolled {
            background: rgba(18, 18, 18, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #282828;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        /* Input Range Styling for Volume/Progress */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 12px; width: 12px;
            border-radius: 50%; background: #ffffff; cursor: pointer;
            margin-top: -4px; 
            opacity: 0;
            transition: opacity 0.2s;
        }
        .range-group:hover input[type=range]::-webkit-slider-thumb { opacity: 1; }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer;
            background: #4d4d4d; border-radius: 2px;
        }
        
        /* Table Row Hover Effect for Play Button */
        .track-row .play-icon { display: none; }
        .track-row:hover .play-icon { display: block; }
        .track-row:hover .track-num { display: none; }
        .track-row .track-heart { opacity: 0; }
        .track-row:hover .track-heart { opacity: 1; }
    </style>
</head>
<body class="bg-black text-white font-sans overflow-hidden h-screen flex flex-col select-none">

    <div class="flex flex-1 overflow-hidden">
        
        <!-- LEFT SIDEBAR -->
        <aside class="w-64 bg-black flex-shrink-0 flex flex-col h-full border-r border-[#282828]">
            <div class="p-6">
                <h1 class="text-2xl font-bold tracking-tight flex items-center gap-2 text-white">
                    <div class="bg-gradient-to-tr from-emerald-500 to-teal-500 p-1.5 rounded-lg">
                        <i data-lucide="waves" class="text-black w-5 h-5"></i> 
                    </div>
                    CloudSync
                </h1>
            </div>

            <nav class="flex-1 overflow-y-auto px-3 space-y-6">
                <ul class="space-y-1">
                    <li>
                        <a href="#" onclick="switchView('all')" id="nav-home" class="flex items-center gap-4 px-4 py-3 text-white bg-[#282828] rounded-md transition font-medium">
                            <i data-lucide="home" class="w-5 h-5"></i> Home Stream
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center gap-4 px-4 py-3 text-gray-400 hover:text-white transition rounded-md font-medium hover:bg-[#1a1a1a]">
                            <i data-lucide="search" class="w-5 h-5"></i> Search
                        </a>
                    </li>
                </ul>

                <div>
                    <div class="flex items-center justify-between px-4 mb-2 group">
                        <h2 class="text-xs uppercase font-bold text-gray-400 tracking-wider">Your Vaults</h2>
                        <button onclick="toggleModal('group-modal')" class="text-gray-400 hover:text-white transition p-1 hover:bg-[#282828] rounded-full">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                        </button>
                    </div>
                    <div class="h-[1px] bg-[#282828] mx-4 mb-3"></div>
                    <ul id="vault-list" class="space-y-1">
                        <!-- Vaults injected via JS -->
                    </ul>
                </div>
            </nav>

            <!-- Install App Area -->
            <div class="p-4 border-t border-[#282828]">
                <button class="flex items-center gap-3 text-sm text-gray-400 hover:text-white transition w-full px-2 py-2">
                    <i data-lucide="download" class="w-4 h-4"></i> Install Desktop App
                </button>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 relative bg-[#121212] flex flex-col overflow-hidden">
            
            <!-- Header (Transparent -> Solid on Scroll) -->
            <header id="main-header" class="glass-header absolute top-0 left-0 right-0 z-20 h-16 px-8 flex items-center justify-between">
                <div class="flex gap-4">
                    <button class="bg-black/40 hover:bg-black/60 rounded-full p-1.5 text-white transition"><i data-lucide="chevron-left" class="w-5 h-5"></i></button>
                    <button class="bg-black/40 hover:bg-black/60 rounded-full p-1.5 text-white transition"><i data-lucide="chevron-right" class="w-5 h-5"></i></button>
                </div>
                
                <div class="flex items-center gap-4">
                    <button onclick="toggleModal('upload-modal')" class="bg-white text-black text-sm font-bold px-4 py-2 rounded-full hover:scale-105 transition flex items-center gap-2 shadow-lg">
                        <i data-lucide="upload-cloud" class="w-4 h-4"></i> Upload Music
                    </button>
                    <button class="p-1 rounded-full hover:bg-[#282828] transition">
                        <div class="w-8 h-8 bg-gradient-to-br from-purple-600 to-blue-600 rounded-full flex items-center justify-center text-xs font-bold border-2 border-transparent">JD</div>
                    </button>
                </div>
            </header>

            <!-- Scrollable Area -->
            <div id="scroll-container" class="flex-1 overflow-y-auto w-full relative">
                
                <!-- Dynamic Hero Background -->
                <div id="hero-bg" class="absolute top-0 left-0 right-0 h-80 bg-gradient-to-b from-[#202020] to-[#121212] -z-10 transition-colors duration-700"></div>

                <div class="pt-24 px-8 pb-32">
                    
                    <!-- Hero Section -->
                    <div class="flex items-end gap-6 mb-8 transition-all duration-300" id="hero-section">
                        <!-- Cover Art (Hidden on Home) -->
                        <div id="hero-img-container" class="hidden shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] transition-transform hover:scale-105 duration-500">
                            <div id="hero-img" class="w-56 h-56 bg-gradient-to-br from-indigo-500 to-purple-800 flex items-center justify-center rounded-md shadow-lg">
                                <i data-lucide="music" class="w-24 h-24 text-white/40 drop-shadow-md"></i>
                            </div>
                        </div>

                        <div class="flex-1">
                            <span class="text-xs font-bold uppercase tracking-widest text-white/90" id="hero-type">Public Stream</span>
                            <h1 class="text-7xl font-black mt-2 mb-4 tracking-tighter text-white drop-shadow-lg" id="hero-title">Home Stream</h1>
                            <p class="text-gray-300 font-medium text-sm flex items-center gap-2" id="hero-desc">
                                Combined tracks from all your active vaults.
                            </p>
                        </div>
                    </div>

                    <!-- Action Bar -->
                    <div class="flex items-center gap-8 mb-8">
                        <button class="w-14 h-14 bg-emerald-500 rounded-full flex items-center justify-center hover:scale-105 hover:bg-emerald-400 transition shadow-xl text-black translate-y-0 active:translate-y-1">
                            <i data-lucide="play" class="w-7 h-7 fill-current ml-1"></i>
                        </button>
                        <button class="text-gray-400 hover:text-white transition"><i data-lucide="shuffle" class="w-8 h-8"></i></button>
                        <div class="flex-1"></div>
                        <div class="relative group">
                            <span class="text-xs text-gray-400 mr-2 uppercase font-bold group-hover:text-white transition">Search in list</span>
                            <button class="text-gray-400 hover:text-white transition"><i data-lucide="search" class="w-5 h-5"></i></button>
                        </div>
                    </div>

                    <!-- Table Header -->
                    <div class="sticky top-[64px] bg-[#121212] z-10 grid grid-cols-[40px_4fr_2fr_2fr_1fr_60px] gap-4 text-gray-400 text-xs border-b border-[#282828] pb-2 mb-4 px-4 uppercase font-bold tracking-wider">
                        <div class="text-center">#</div>
                        <div>Title</div>
                        <div>Album</div>
                        <div>Date Added</div>
                        <div>Vault</div>
                        <div class="text-right"><i data-lucide="clock" class="w-4 h-4 ml-auto"></i></div>
                    </div>

                    <!-- Songs Container -->
                    <div id="song-list" class="flex flex-col">
                        <!-- Rows injected here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- PLAYER BAR (Fixed Bottom) -->
    <footer id="player-bar" class="hidden fixed bottom-0 left-0 right-0 h-[90px] bg-[#181818] border-t border-[#282828] px-4 flex items-center justify-between z-50 transition-transform duration-300 translate-y-full">
        
        <!-- Now Playing -->
        <div class="flex items-center gap-4 w-[30%]">
            <div id="player-art" class="w-14 h-14 bg-gray-800 rounded shadow-lg flex items-center justify-center flex-shrink-0 border border-white/10 relative group cursor-pointer">
                <i data-lucide="music-2" class="text-gray-500"></i>
                <div class="absolute inset-0 bg-black/50 hidden group-hover:flex items-center justify-center rounded">
                    <i data-lucide="chevron-up" class="w-6 h-6 text-white"></i>
                </div>
            </div>
            <div class="overflow-hidden">
                <div id="player-title" class="text-sm font-semibold text-white hover:underline cursor-pointer truncate">Select a song</div>
                <div id="player-artist" class="text-xs text-gray-400 hover:text-white hover:underline cursor-pointer truncate transition">...</div>
            </div>
            <button class="text-gray-400 hover:text-emerald-500 transition ml-2"><i data-lucide="heart" class="w-4 h-4"></i></button>
        </div>

        <!-- Controls -->
        <div class="flex flex-col items-center w-[40%] max-w-2xl">
            <div class="flex items-center gap-6 mb-1">
                <button class="text-gray-400 hover:text-white transition"><i data-lucide="shuffle" class="w-4 h-4"></i></button>
                <button class="text-gray-300 hover:text-white transition"><i data-lucide="skip-back" class="w-5 h-5 fill-current"></i></button>
                <button id="play-pause-btn" class="bg-white rounded-full p-2 text-black hover:scale-105 transition shadow-lg">
                    <i data-lucide="play" class="w-5 h-5 fill-current ml-0.5"></i>
                </button>
                <button class="text-gray-300 hover:text-white transition"><i data-lucide="skip-forward" class="w-5 h-5 fill-current"></i></button>
                <button class="text-gray-400 hover:text-white transition"><i data-lucide="repeat" class="w-4 h-4"></i></button>
            </div>
            <div class="w-full flex items-center gap-2 text-xs text-gray-400 font-mono range-group">
                <span id="current-time">0:45</span>
                <input type="range" min="0" max="100" value="30" class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer hover:bg-emerald-500 transition-colors">
                <span id="total-time">3:12</span>
            </div>
        </div>

        <!-- Volume & Tools -->
        <div class="flex items-center justify-end gap-3 w-[30%]">
            <button class="text-gray-400 hover:text-white p-2 rounded-md hover:bg-[#282828] transition"><i data-lucide="mic-2" class="w-4 h-4"></i></button>
            <button class="text-gray-400 hover:text-white p-2 rounded-md hover:bg-[#282828] transition"><i data-lucide="list-music" class="w-4 h-4"></i></button>
            <button class="text-gray-400 hover:text-white p-2 rounded-md hover:bg-[#282828] transition"><i data-lucide="monitor-speaker" class="w-4 h-4"></i></button>
            <div class="flex items-center gap-2 w-32 range-group ml-2">
                <i data-lucide="volume-2" class="w-4 h-4 text-gray-400"></i>
                <input type="range" class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer hover:bg-white transition-colors">
            </div>
        </div>
    </footer>

    <!-- UPLOAD MODAL -->
    <div id="upload-modal" class="fixed inset-0 bg-black/60 hidden z-[70] flex items-center justify-center backdrop-blur-sm transition-opacity opacity-0">
        <div class="bg-[#282828] rounded-xl p-8 w-full max-w-lg shadow-2xl border border-[#333] transform scale-95 transition-transform">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Add to Vault</h2>
                <button onclick="toggleModal('upload-modal')" class="text-gray-400 hover:text-white bg-[#333] p-1 rounded-full"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            
            <form onsubmit="handleUpload(event)" class="space-y-4">
                <div class="border-2 border-dashed border-[#444] rounded-xl p-10 text-center hover:border-white hover:bg-[#333] transition cursor-pointer group">
                    <div class="w-16 h-16 bg-[#333] rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition group-hover:bg-[#444]">
                        <i data-lucide="upload" class="w-8 h-8 text-gray-400 group-hover:text-white"></i>
                    </div>
                    <p class="text-base text-white font-bold">Drag and drop audio files</p>
                    <p class="text-sm text-gray-500 mt-1">MP3, WAV, FLAC (Max 50MB)</p>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Track Title</label>
                        <input type="text" placeholder="Song Name" class="w-full bg-[#181818] border border-[#333] rounded p-3 text-sm focus:border-emerald-500 focus:outline-none text-white mt-1 transition-colors">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Artist</label>
                        <input type="text" placeholder="Artist Name" class="w-full bg-[#181818] border border-[#333] rounded p-3 text-sm focus:border-emerald-500 focus:outline-none text-white mt-1 transition-colors">
                    </div>
                </div>

                <div>
                    <label class="text-xs font-bold text-gray-400 uppercase tracking-wide">Select Vault</label>
                    <div class="relative mt-1">
                        <select class="w-full bg-[#181818] border border-[#333] rounded p-3 text-sm focus:border-emerald-500 focus:outline-none text-white appearance-none" id="upload-group-select">
                            <!-- Options filled by JS -->
                        </select>
                        <i data-lucide="chevron-down" class="absolute right-3 top-3.5 w-4 h-4 text-gray-500 pointer-events-none"></i>
                    </div>
                </div>

                <div class="pt-4">
                    <button type="submit" class="w-full bg-emerald-500 text-black font-bold py-3.5 rounded-full hover:scale-[1.02] hover:bg-emerald-400 transition shadow-lg text-sm uppercase tracking-wide">Start Upload</button>
                </div>
            </form>
        </div>
    </div>

    <!-- SCRIPT -->
    <script>
        // --- CONFIG ---
        const groups = [
            { id: 'g1', name: 'JukeboxHQ', color: 'from-purple-600 to-indigo-600', text: 'text-purple-400', border: 'border-purple-500/30', bg_hex: '#2e1065' },
            { id: 'g2', name: 'Chill Vibes', color: 'from-blue-500 to-cyan-500', text: 'text-blue-400', border: 'border-blue-500/30', bg_hex: '#1e3a8a' },
            { id: 'g3', name: 'Gym Crew', color: 'from-red-600 to-orange-600', text: 'text-red-400', border: 'border-red-500/30', bg_hex: '#7f1d1d' },
            { id: 'g4', name: 'Indie Discoveries', color: 'from-yellow-500 to-orange-500', text: 'text-yellow-400', border: 'border-yellow-500/30', bg_hex: '#713f12' }
        ];

        const songs = [
            { id: 1, title: 'Midnight City (Unreleased Remix)', artist: 'M83', album: 'Private Edit', group: 'g1', duration: '4:03', date: '2 days ago' },
            { id: 2, title: 'Demo_v3_Final_Real.mp3', artist: 'Dave from Finance', album: 'SoundCloud Dumps', group: 'g1', duration: '2:15', date: '5 hours ago' },
            { id: 3, title: 'Lo-Fi Study Beats Mix', artist: 'Unknown', album: 'YouTube Rip', group: 'g2', duration: '45:12', date: '1 week ago' },
            { id: 4, title: 'Workout Set 2024', artist: 'DJ Generic', album: 'Gym Trax', group: 'g3', duration: '32:00', date: '3 days ago' },
            { id: 5, title: 'Acoustic Cover (Live)', artist: 'Sarah', album: 'Voice Memos', group: 'g2', duration: '3:45', date: 'Just now' },
            { id: 6, title: 'Bass Test 9000', artist: 'Subwoofer', album: 'Tests', group: 'g1', duration: '0:55', date: '1 day ago' },
            { id: 7, title: 'Obscure Track 1', artist: 'The Band', album: 'Rehearsal', group: 'g4', duration: '5:10', date: '2 weeks ago' },
            { id: 8, title: 'Obscure Track 2', artist: 'The Band', album: 'Rehearsal', group: 'g4', duration: '4:20', date: '2 weeks ago' },
             { id: 9, title: 'Synthwave Idea', artist: 'Producer X', album: 'Demos', group: 'g1', duration: '3:12', date: 'Yesterday' }
        ];

        let currentView = 'all';

        // --- INIT ---
        function init() {
            lucide.createIcons();
            renderVaultList();
            renderSongList();
            fillSelectOptions();
            
            // Scroll Listener for Glass Header
            const scrollContainer = document.getElementById('scroll-container');
            const header = document.getElementById('main-header');
            
            scrollContainer.addEventListener('scroll', () => {
                if (scrollContainer.scrollTop > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            // Keyboard Play/Pause Simulation
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault(); // Stop scrolling
                    const btn = document.getElementById('play-pause-btn');
                    if(btn) btn.click();
                }
            });

            // Play/Pause Toggle Visuals
            const btn = document.getElementById('play-pause-btn');
            btn.addEventListener('click', () => {
                const icon = btn.querySelector('svg');
                if (icon.classList.contains('lucide-play')) {
                    btn.innerHTML = '<i data-lucide="pause" class="w-5 h-5 fill-current ml-0.5"></i>';
                } else {
                    btn.innerHTML = '<i data-lucide="play" class="w-5 h-5 fill-current ml-0.5"></i>';
                }
                lucide.createIcons();
            });
        }

        // --- RENDERERS ---

        function renderVaultList() {
            const list = document.getElementById('vault-list');
            list.innerHTML = groups.map(g => `
                <li>
                    <a href="#" onclick="switchView('${g.id}')" class="flex items-center gap-3 px-4 py-2 text-gray-400 hover:text-white transition rounded-md group hover:bg-[#1a1a1a]">
                        <div class="w-8 h-8 rounded bg-[#282828] flex items-center justify-center text-xs font-bold uppercase group-hover:bg-white group-hover:text-black transition shadow-sm">
                            ${g.name.substring(0, 2)}
                        </div>
                        <span class="truncate text-sm font-medium">${g.name}</span>
                    </a>
                </li>
            `).join('');
        }

        function switchView(viewId) {
            currentView = viewId;
            const heroTitle = document.getElementById('hero-title');
            const heroDesc = document.getElementById('hero-desc');
            const heroImgContainer = document.getElementById('hero-img-container');
            const navHome = document.getElementById('nav-home');
            const heroBg = document.getElementById('hero-bg');

            // Nav State
            if (viewId === 'all') {
                navHome.classList.replace('text-gray-400', 'text-white');
                navHome.classList.replace('hover:text-white', 'text-white');
                navHome.classList.add('bg-[#282828]');
            } else {
                navHome.classList.remove('bg-[#282828]');
                navHome.classList.replace('text-white', 'text-gray-400');
            }

            // Hero Logic
            if (viewId === 'all') {
                heroTitle.textContent = "Home Stream";
                heroDesc.innerHTML = "Combined tracks from all your active vaults.";
                heroImgContainer.classList.add('hidden');
                heroBg.className = "absolute top-0 left-0 right-0 h-80 bg-gradient-to-b from-[#202020] to-[#121212] -z-10 transition-colors duration-700";
            } else {
                const group = groups.find(g => g.id === viewId);
                heroTitle.textContent = group.name;
                heroDesc.innerHTML = `<span class="bg-white/10 px-2 py-0.5 rounded text-xs uppercase font-bold tracking-wider text-white">Private Vault</span> ${songs.filter(s => s.group === viewId).length} songs â€¢ Created by You`;
                heroImgContainer.classList.remove('hidden');
                
                // Set hero gradient based on group color
                heroBg.style.background = `linear-gradient(to bottom, ${group.bg_hex}40, #121212)`;
                const iconContainer = document.getElementById('hero-img');
                iconContainer.className = `w-56 h-56 bg-gradient-to-br ${group.color} flex items-center justify-center rounded-md shadow-lg`;
            }

            renderSongList();
        }

        function renderSongList() {
            const list = document.getElementById('song-list');
            const filteredSongs = currentView === 'all' ? songs : songs.filter(s => s.group === currentView);

            if (filteredSongs.length === 0) {
                list.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-20 text-gray-500">
                        <i data-lucide="music" class="w-12 h-12 mb-4 opacity-50"></i>
                        <p>No songs here yet.</p>
                        <button onclick="toggleModal('upload-modal')" class="mt-4 text-white font-bold hover:underline">Upload something?</button>
                    </div>`;
                lucide.createIcons();
                return;
            }

            list.innerHTML = filteredSongs.map((s, index) => {
                const group = groups.find(g => g.id === s.group);
                return `
                <div onclick="playSong(${s.id})" class="track-row grid grid-cols-[40px_4fr_2fr_2fr_1fr_60px] gap-4 px-4 py-2 rounded-md hover:bg-white/10 group transition items-center text-sm text-gray-400 border-b border-transparent hover:border-transparent cursor-pointer">
                    
                    <!-- Index / Play Btn -->
                    <div class="flex items-center justify-center relative w-5">
                        <span class="track-num group-hover:hidden font-mono text-gray-500">${index + 1}</span>
                        <i data-lucide="play" class="play-icon w-4 h-4 fill-white text-white absolute left-0.5"></i>
                        <i data-lucide="bar-chart-2" class="w-4 h-4 text-emerald-500 hidden active-icon"></i>
                    </div>
                    
                    <!-- Title/Image -->
                    <div class="flex items-center gap-4 overflow-hidden">
                        <div class="w-10 h-10 bg-[#333] flex-shrink-0 rounded flex items-center justify-center">
                            <i data-lucide="music" class="w-5 h-5 text-gray-500"></i>
                        </div>
                        <div class="flex flex-col overflow-hidden">
                            <span class="text-white font-medium truncate mb-0.5 hover:underline decoration-white/50">${s.title}</span>
                            <span class="text-xs group-hover:text-white transition truncate hover:underline decoration-white/50">${s.artist}</span>
                        </div>
                    </div>

                    <!-- Album -->
                    <div class="truncate group-hover:text-white transition hover:underline decoration-white/50">${s.album}</div>
                    
                    <!-- Date -->
                    <div class="truncate text-xs">${s.date}</div>

                    <!-- Vault Badge -->
                    <div class="truncate">
                         <span class="text-[10px] uppercase font-bold px-2 py-0.5 rounded-sm border ${group.border} ${group.text} bg-opacity-10 bg-white tracking-wider hover:scale-105 inline-block transition cursor-pointer">
                            ${group.name}
                        </span>
                    </div>

                    <!-- Duration / Heart -->
                    <div class="flex items-center justify-end gap-4">
                         <button class="track-heart hover:text-emerald-500 transition"><i data-lucide="heart" class="w-4 h-4"></i></button>
                         <span class="font-mono text-xs">${s.duration}</span>
                         <button class="opacity-0 group-hover:opacity-100 transition hover:text-white"><i data-lucide="more-horizontal" class="w-4 h-4"></i></button>
                    </div>
                </div>
            `}).join('');
            
            lucide.createIcons();
        }

        // --- ACTIONS ---

        function playSong(id) {
            const song = songs.find(s => s.id === id);
            
            // Show Player Bar (Slide Up)
            const playerBar = document.getElementById('player-bar');
            playerBar.classList.remove('hidden');
            setTimeout(() => playerBar.classList.remove('translate-y-full'), 10); // Trigger transition

            // Update UI Data
            document.getElementById('player-title').textContent = song.title;
            document.getElementById('player-artist').textContent = song.artist;
            document.getElementById('play-pause-btn').innerHTML = '<i data-lucide="pause" class="w-5 h-5 fill-current ml-0.5"></i>';
            
            // Highlight row visually (mockup only)
            const rows = document.querySelectorAll('.track-row');
            rows.forEach(r => {
                r.querySelector('.track-num').style.color = '';
                r.querySelector('.title-text')?.classList.remove('text-emerald-500');
            });
            
            lucide.createIcons();
        }

        function toggleModal(modalId) {
            const modal = document.getElementById(modalId);
            const content = modal.querySelector('div');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                // Small delay to allow display:block to apply before opacity transition
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    content.classList.remove('scale-95');
                    content.classList.add('scale-100');
                }, 10);
            } else {
                modal.classList.add('opacity-0');
                content.classList.remove('scale-100');
                content.classList.add('scale-95');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        function fillSelectOptions() {
            document.getElementById('upload-group-select').innerHTML = groups.map(g => `<option value="${g.id}">${g.name}</option>`).join('');
        }
        function handleUpload(e) { 
            e.preventDefault(); 
            const btn = e.target.querySelector('button');
            btn.innerHTML = '<i data-lucide="loader" class="animate-spin w-4 h-4 mr-2"></i> Uploading...';
            setTimeout(() => {
                toggleModal('upload-modal'); 
                btn.innerHTML = 'Start Upload';
                alert("Prototype: Song uploaded!"); 
            }, 1000);
        }

        init();
    </script>
</body>
</html>